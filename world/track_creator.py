import cv2
import numpy as np
import pandas as pd

  
# save the dataframe as a csv file 

def generate_sdf(inner, outer):

    cone_model_template = '''
     <model name='cone_{}'>
      <link name='cone_{}_link'>
        <inertial>
			<mass>0</mass>
			<inertia>
			<ixx>0.166667</ixx>
			<ixy>0</ixy>
			<ixz>0</ixz>
			<iyy>0.166667</iyy>
			<iyz>0</iyz>
			<izz>0.166667</izz>
			</inertia>
		</inertial>
        <collision name='cone_{}_collision'>
          <geometry>
            <mesh>
              <uri>/models/cone/meshes/cone.stl</uri>
              <scale>0.001 0.001 0.001</scale>
            </mesh>
          </geometry>
        </collision>
        <visual name='cone_{}_visual'>
          <geometry>
            <mesh>
              <uri>/models/cone/meshes/cone.stl</uri>
              <scale>0.001 0.001 0.001</scale>
            </mesh>
          </geometry>
          <material>
            <ambient>{}</ambient>
            <diffuse>{}</diffuse>
            <specular>{}</specular>
          </material>
        </visual>
        
        <enable_wind>false</enable_wind>
      </link>
      <pose>{}</pose>
      <static>true</static>
      </model>
      '''

    cones = ""
 
    for i, coord in enumerate(inner):

        #x, y, z, color = coord[0:4]
        x, y = coord[0:2]
        

        #pose = "{} {} 1.57 0 0".format(x, y)

        pose = "{} {} {} 1.57 0 0".format(x, y ,0.0)

        #inner = yellow cones
        ambient = '1 1 0 1'
        diffuse = '1 1 0 1'
        specular = '1 1 0 1'

        cones += cone_model_template.format(i, i, i, i, ambient, diffuse, specular, pose)

    for i, coord in enumerate(outer):
        
        bias = len(inner)
        #x, y, z, color = coord[0:4]
        x, y = coord[0:2]

        #pose = "{} {} 1.57 0 0".format(x, y)
        
        pose = "{} {} {} 1.57 0 0".format(x, y ,0.0)

        #outer = blue cones
        ambient = '0 0 1 1'
        diffuse = '0 0 1 1'
        specular = '0 0 1 1'

        idx = i + bias + 1
        cones += cone_model_template.format(idx,idx, idx, idx, ambient, diffuse, specular, pose)
    return cones

def scale_track(track_coordinates, scale_factor):
    xy_coords = track_coordinates[:, 0:2]
    #print(track_coordinates[:,0:2])


    centroid = np.mean(xy_coords, axis=0)
    #print(centroid)
    # Translate the track coordinates so that the centroid is at the origin
    translated_track = xy_coords - centroid

    # Scale down the translated track uniformly
    scaled_track_xy = translated_track * scale_factor

    # Translate the scaled track back to its original position
    #scaled_track_xy += centroid
    
    #print(scaled_track_xy)
    #print(scaled_track_xy)
    #scaled_track = np.hstack((scaled_track_xy, track_coordinates[:, 2:4]))
    #scaled_track = np.hstack((scaled_track_xy, track_coordinates[:]))
    #print(track_coordinates[:, 2:4])
    return scaled_track_xy

def main():
    # totali
    #innerConePosition = np.array([[6.49447171658257,41.7389113024907, 0, 1],[8.49189149682204,41.8037451937836, 0, 1],[10.4848751821667,41.8690573815958, 0, 1],[12.4735170408320,41.9319164105607, 0, 1],[14.4579005366844,41.9894100214277, 0, 1],[16.4380855350346,42.0386448286094, 0, 1],[22.3534294484539,42.1081444836209, 0, 1],[24.3165071700586,42.0957886616701, 0, 1],[26.2748937812757,42.0609961552005, 0, 1],[28.2282468521326,42.0009961057027, 0, 1],[30.1761149294924,41.9130441723441, 0, 1],[32.0795946202318,41.7896079706255, 0, 1],[33.8817199327800,41.5914171121172, 0, 1],[37.1238045770298,40.8042280456036, 0, 1],[38.5108000329817,40.1631834270328, 0, 1],[40.7498148915033,38.2980872410971, 0, 1],[41.6428012725483,37.0572740958520, 0, 1],[42.3684952713925,35.6541128117207, 0, 1],[42.9237412798850,34.1220862330776, 0, 1],[43.4562377484922,30.9418382209873, 0, 1],[43.4041825643156,29.3682424552239, 0, 1],[43.1310900802234,27.8454335309325, 0, 1],[42.6373380962399,26.4081334491868, 0, 1],[41.9213606895600,25.0723633391567, 0, 1],[39.8493389129556,22.6733478226331, 0, 1],[37.1330772214184,20.7325660900255, 0, 1],[35.6438750732877,19.9947555768891, 0, 1],[34.0970198095490,19.4366654165469, 0, 1],[32.5117013027651,19.0709696852617, 0, 1],[30.9105163807122,18.9081142458350, 0, 1],[29.3050197645280,18.9545691109581, 0, 1],[27.6851829730976,19.2045278218877, 0, 1],[24.4759113345748,20.2570787967781, 0, 1],[21.3685688158133,21.9377743574784, 0, 1],[19.8072187451783,22.9775182612717, 0, 1],[18.2040616100214,24.1054677217171, 0, 1],[16.5291821840059,25.2778069272720, 0, 1],[14.7490275765791,26.4446189166734, 0, 1],[10.7566166245341,28.5122919557571, 0, 1],[8.59035703212379,29.2671114310357, 0, 1],[6.36970146209175,29.8034933598624, 0, 1],[4.11753580708921,30.1252372241127, 0, 1],[-0.405973075502234,30.1500578730274, 0, 1],[-2.75740378439869,29.8083496207198, 0, 1],[-7.53032772904185,27.7630095130657, 0, 1],[-9.55882345130782,25.8360602858122, 0, 1],[-10.9967405848897,23.4446538263345, 0, 1],[-11.7530941810305,20.7728147412547, 0, 1],[-11.7945553145768,18.0098876247875, 0, 1],[-11.1377067999357,15.3398589997259, 0, 1],[-9.84329815385971,12.9293912425976, 0, 1],[-4.31864858110937,8.32717777382664, 0, 1],[-2.64821833398598,7.33684919790624, 0, 1],[-1.23396167898668,6.38669110355496, 0, 1],[-0.139159724307982,5.41310565569044, 0, 1],[0.583196113153409,4.42232005043196, 0, 1],[1.00846697640521,3.25999992647677, 0, 1],[1.42452204766312,-0.235409796458984, 0, 1],[1.70769766109080,-2.50157264279400, 0, 1],[2.43395748729283,-5.02746251429141, 0, 1],[5.90118769712182,-9.36241405660719, 0, 1],[8.13219227914984,-10.6723062142501, 0, 1],[10.4108490166236,-11.5249176387577, 0, 1],[14.7174578544944,-12.4162331505645, 0, 1],[16.6611999625517,-12.7135418322201, 0, 1],[18.4669199253036,-13.0527675263258, 0, 1],[20.2513584750154,-13.4902268953088, 0, 1],[22.0275043214267,-14.0208096878619, 0, 1],[23.7938485314227,-14.6351269687361, 0, 1],[29.0380553533840,-16.8864873288738, 0, 1],[30.7681622622371,-17.7392626196140, 0, 1],[32.3760783979903,-18.6039808584518, 0, 1],[33.7897740653103,-19.5166383512928, 0, 1],[34.9667330396653,-20.5090458088496, 0, 1],[35.8614855279756,-21.5808775016001, 0, 1],[36.4612858521334,-22.7451308643890, 0, 1],[36.8711477182864,-25.4557910211687, 0, 1],[36.6696611457761,-26.8930663715963, 0, 1],[35.5175477601575,-29.6867414698392, 0, 1],[34.6369025552692,-30.9011171932826, 0, 1],[33.5888282300982,-31.9233335254203, 0, 1],[32.4026659456202,-32.7184009884738, 0, 1],[29.6211021726631,-33.5886007841515, 0, 1],[27.9849204584717,-33.7170193136260, 0, 1],[26.2183096377485,-33.6848022646400, 0, 1],[24.3309596262912,-33.5465676173721, 0, 1],[22.3208062313579,-33.3726612899257, 0, 1],[18.1328018280879,-33.1964401661521, 0, 1],[14.1429922166079,-33.1731958647648, 0, 1],[12.2313503871593,-33.1266878316603, 0, 1],[10.3778348140314,-33.0132052855498, 0, 1],[8.58829435522285,-32.8040580663346, 0, 1],[6.84064584789227,-32.4725374962639, 0, 1],[5.07009944482550,-32.0172508962124, 0, 1],[3.27322533222869,-31.4640545504384, 0, 1],[-0.418687595522242,-30.1796696447230, 0, 1],[-4.09627739578414,-28.8238238024923, 0, 1],[-5.89202160786470,-28.1122858460715, 0, 1],[-7.65255868890126,-27.3645667343373, 0, 1],[-9.37355826729420,-26.5706223212060, 0, 1],[-11.0772549160090,-25.7164049091686, 0, 1],[-14.4775165017317,-23.8562440887552, 0, 1],[-16.1852335110450,-22.8738429891042, 0, 1],[-17.9066984601430,-21.8724503885825, 0, 1],[-19.6280899733090,-20.8717543910881, 0, 1],[-22.9283852622260,-18.8697018891971, 0, 1],[-24.4790807692059,-17.8277052050408, 0, 1],[-27.3051265922114,-15.5801090683244, 0, 1],[-28.5448479313762,-14.3530174024786, 0, 1],[-29.6530218737847,-13.0404842531107, 0, 1],[-30.6444406510768,-11.6234683085559, 0, 1],[-31.5169602294234,-10.1146356600596, 0, 1],[-32.2692264908853,-8.52739205631154, 0, 1],[-32.9016624434539,-6.87420998418598, 0, 1],[-34.1160057737752,-1.60803776182190, 0, 1],[-34.3261608207142,0.237322459171913, 0, 1],[-34.4624174228984,2.11880932640591, 0, 1],[-34.5407037273032,4.03273612643633, 0, 1],[-34.5779532171168,5.97700580252438, 0, 1],[-34.5920061096721,7.95066706685753, 0, 1],[-34.6203010935088,11.9628384547546, 0, 1],[-34.6463516562825,13.9656473217268, 0, 1],[-34.6751545298116,15.9616504117489, 0, 1],[-34.7230350194217,19.9334733431980, 0, 1],[-34.7332354577762,21.9093507078716, 0, 1],[-34.7284338451120,23.8784778261844, 0, 1],[-34.6466389854161,27.7320065787716, 0, 1],[-34.4887912178893,29.4532110956616, 0, 1],[-34.1674004338218,30.9833511541837, 0, 1],[-33.6523388115164,32.2835000565933, 0, 1],[-32.9540435069214,33.3001054449054, 0, 1],[-32.0153881487289,34.0792118997941, 0, 1],[-28.7867224485036,35.7027232116937, 0, 1],[-26.8737074947600,36.7067299514829, 0, 1],[-21.7623826032159,39.5958663210330, 0, 1],[-20.1418625665089,40.3549987041733, 0, 1],[-18.5286281071084,40.9596629960629, 0, 1],[-16.9269162480936,41.3805845888608, 0, 1],[-15.2947586791386,41.6060043323431, 0, 1],[-13.5312107482484,41.6777684016896, 0, 1],[-9.64289482747188,41.5853268011948, 0, 1],[-7.61112976471737,41.5421552074769, 0, 1],[-5.58318659783131,41.5226049040385, 0, 1],[-1.53976115651896,41.5427010208205, 0, 1],[0.475431094342800,41.5765527022834, 0, 1],[2.48619653317858,41.6224387797260, 0, 1],[6.49447171658257,41.7389113024907, 0, 1],[8.49189149682204,41.8037451937836, 0, 1],[10.4848751821667,41.8690573815958, 0, 1],[12.4735170408320,41.9319164105607, 0, 1],[14.4579005366844,41.9894100214277, 0, 1]])
    #outerConePosition = np.array([[8.29483356036796,47.8005083348189, 0, 2],[10.2903642978411,47.8659036790991, 0, 2],[12.2903853701921,47.9291209919643, 0, 2],[14.2949817462715,47.9871977358879, 0, 2],[16.3042155724446,48.0371512121282, 0, 2],[18.3181128601480,48.0759783968909, 0, 2],[24.3872198920862,48.0953719564451, 0, 2],[26.4188343006777,48.0592693339474, 0, 2],[28.4542241392916,47.9967391176812, 0, 2],[30.4929111587893,47.9046750145358, 0, 2],[32.5715480310539,47.7694057800486, 0, 2],[34.7354354110013,47.5303707137414, 0, 2],[36.9671887094624,47.1090924863221, 0, 2],[41.4608084515852,45.3878796220444, 0, 2],[43.5486168233166,43.9466679046951, 0, 2],[46.7637769841785,40.1838709296144, 0, 2],[47.8711744070693,38.0458741563760, 0, 2],[48.6759026786991,35.8287318442088, 0, 2],[49.2095764033813,33.5308461962448, 0, 2],[49.3717906596030,28.7456240961468, 0, 2],[48.9402528124274,26.3442245678724, 0, 2],[48.1379348685719,24.0115869446911, 0, 2],[46.9718766730536,21.8331831495909, 0, 2],[45.5183908761479,19.8937545099424, 0, 2],[42.0344522843090,16.7521854290723, 0, 2],[38.0024261140352,14.4777602906678, 0, 2],[35.7974585974047,13.6826661179064, 0, 2],[33.4965697064231,13.1523520909686, 0, 2],[31.1302557069132,12.9121393769316, 0, 2],[28.7495405480103,12.9803375419597, 0, 2],[26.4275819814214,13.3378047377686, 0, 2],[24.1935407090117,13.9452300781406, 0, 2],[20.0475993937396,15.7534500265274, 0, 2],[16.3951857815830,18.0421326577611, 0, 2],[14.7344934919394,19.2103582158950, 0, 2],[13.1401972893467,20.3265665388672, 0, 2],[11.5833537070008,21.3477072094266, 0, 2],[10.0428032559345,22.2341839570762, 0, 2],[6.90006888859156,23.5101221144020, 0, 2],[5.24310276950825,23.9102111346615, 0, 2],[3.54614319085073,24.1525066527486, 0, 2],[1.82453456285617,24.2384953941222, 0, 2],[-1.49646987010121,23.9423419780574, 0, 2],[-2.88611819700968,23.5188503619890, 0, 2],[-4.87663538345929,22.0841121388762, 0, 2],[-5.48860547878733,21.0654842962416, 0, 2],[-5.81567263287249,19.9085084532591, 0, 2],[-5.83349192339180,18.6923268134878, 0, 2],[-5.53917605118359,17.4977407053060, 0, 2],[-4.95012865665813,16.4016948398736, 0, 2],[-4.05317915721677,15.4107620877673, 0, 2],[0.492121533127250,12.4494087837712, 0, 2],[2.38653784056378,11.1712478467585, 0, 2],[4.26363974073903,9.48929957533922, 0, 2],[5.87263326747036,7.25460792254726, 0, 2],[6.83628597561633,4.68706884998182, 0, 2],[7.22868549746256,2.31823546262226, 0, 2],[7.60968340642873,-1.42149659832866, 0, 2],[7.97509056184070,-2.72619237583490, 0, 2],[8.54802041473498,-3.68009075055991, 0, 2],[10.6601317831479,-5.23084300440234, 0, 2],[12.1167992046948,-5.77254995615783, 0, 2],[13.7805173778787,-6.17261534649334, 0, 2],[17.6231089179688,-6.79114948102549, 0, 2],[19.7388585053217,-7.18913620702706, 0, 2],[21.8298950982966,-7.70159820373082, 0, 2],[23.8771264994103,-8.31301696223576, 0, 2],[25.8797524901441,-9.00938215804746, 0, 2],[27.8385154732156,-9.77726113305095, 0, 2],[33.4828656272925,-12.3885256946890, 0, 2],[35.3884273243004,-13.4149776838374, 0, 2],[37.3243202944926,-14.6682383106842, 0, 2],[39.1922962154652,-16.2493960759111, 0, 2],[40.8455371260767,-18.2403341823979, 0, 2],[42.0705518955054,-20.6153105774461, 0, 2],[42.7346589897432,-23.1596769590206, 0, 2],[42.5147079384368,-28.2478460553850, 0, 2],[41.7538036771420,-30.6144579632713, 0, 2],[39.1831183440142,-34.8167170198948, 0, 2],[37.3770559671547,-36.5762176430613, 0, 2],[35.2523671945937,-37.9984770098583, 0, 2],[32.8791324240351,-38.9934826446380, 0, 2],[28.1270516052592,-39.7153356388220, 0, 2],[25.9046030197368,-39.6765956654354, 0, 2],[23.8121031317075,-39.5240911796868, 0, 2],[21.8464792201864,-39.3538830619781, 0, 2],[19.9742827992146,-39.2418187116909, 0, 2],[16.0937484438592,-39.1847191943436, 0, 2],[11.9928246424488,-39.1219447460144, 0, 2],[9.86352410414552,-38.9911216862446, 0, 2],[7.69014987529461,-38.7364552625087, 0, 2],[5.51782683234722,-38.3249002543397, 0, 2],[3.42382206323132,-37.7869797271760, 0, 2],[1.40682879137184,-37.1663842455962, 0, 2],[-0.541821138011257,-36.5027177844325, 0, 2],[-4.34015621146816,-35.1410426555394, 0, 2],[-8.16436000121084,-33.6653461038145, 0, 2],[-10.0767778404464,-32.8530238495275, 0, 2],[-11.9792230934156,-31.9752972248347, 0, 2],[-13.8428086034457,-31.0410375539532, 0, 2],[-15.6623928384561,-30.0682796038662, 0, 2],[-19.1958077261686,-28.0638760232219, 0, 2],[-20.9238240938196,-27.0586776214187, 0, 2],[-22.6524765196268,-26.0537507263292, 0, 2],[-24.4077080359509,-25.0144494209715, 0, 2],[-27.9360780875981,-22.7317004681533, 0, 2],[-29.6698538901663,-21.4381474644069, 0, 2],[-32.9453564203185,-18.4316844689044, 0, 2],[-34.4107565227371,-16.6961594315364, 0, 2],[-35.7065080013589,-14.8445665903860, 0, 2],[-36.8313109009813,-12.8998963192641, 0, 2],[-37.7878917266941,-10.8820330087871, 0, 2],[-38.5811746376266,-8.80892992160400, 0, 2],[-39.2178699842561,-6.69652639898087, 0, 2],[-40.3011807339499,-0.309611756649864, 0, 2],[-40.4533406202231,1.78890139416343, 0, 2],[-40.5382789183978,3.86217286202336, 0, 2],[-40.5775538214583,5.90777727960811, 0, 2],[-40.5919497511314,7.92466131148779, 0, 2],[-40.6014196538181,9.91275631233656, 0, 2],[-40.6457557289961,13.8810850824754, 0, 2],[-40.6745334498720,15.8753221224371, 0, 2],[-40.7017394704418,17.8763494567535, 0, 2],[-40.7332264185658,21.8989357934230, 0, 2],[-40.7282871101318,23.9204396925825, 0, 2],[-40.7033369152928,25.9485603009070, 0, 2],[-40.4291604069450,30.2970202551981, 0, 2],[-39.9260632680985,32.6679289532538, 0, 2],[-38.9665731582284,35.0689826553948, 0, 2],[-37.4022554152914,37.3266934320522, 0, 2],[-35.2924298638551,39.1052438930590, 0, 2],[-33.2056190082383,40.2549711124138, 0, 2],[-29.7935826692359,41.9483259837501, 0, 2],[-28.1179159337869,42.9113732230407, 0, 2],[-22.4882559681602,45.8771756304123, 0, 2],[-20.3655683666973,46.6715497668858, 0, 2],[-18.1093389106216,47.2629205744315, 0, 2],[-15.7909195473899,47.5854545071348, 0, 2],[-13.5681633690504,47.6776546092619, 0, 2],[-11.4644254110510,47.6457593795914, 0, 2],[-7.51988574761303,47.5414613781388, 0, 2],[-5.55737846449435,47.5225493988029, 0, 2],[-3.59058902924480,47.5236739806379, 0, 2],[0.355197826404633,47.5753479114301, 0, 2],[2.33404449770947,47.6205092826547, 0, 2],[4.31684977705784,47.6749328204622, 0, 2],[8.29483356036796,47.8005083348189, 0, 2],[10.2903642978411,47.8659036790991, 0, 2],[12.2903853701921,47.9291209919643, 0, 2],[14.2949817462715,47.9871977358879, 0, 2],[16.3042155724446,48.0371512121282, 0, 2]])

    innerConePosition = np.array([[6.49447171658257,41.7389113024907,0.0,1.0],[10.4848751821667,41.8690573815958,0.0,1.0],[14.4579005366844,41.9894100214277,0.0,1.0],[22.3534294484539,42.1081444836209,0.0,1.0],[26.2748937812757,42.0609961552005,0.0,1.0],[30.1761149294924,41.9130441723441,0.0,1.0],[33.88171993278,41.5914171121172,0.0,1.0],[38.5108000329817,40.1631834270328,0.0,1.0],[41.6428012725483,37.057274095852,0.0,1.0],[42.923741279885,34.1220862330776,0.0,1.0],[43.4041825643156,29.3682424552239,0.0,1.0],[42.6373380962399,26.4081334491868,0.0,1.0],[39.8493389129556,22.6733478226331,0.0,1.0],[35.6438750732877,19.9947555768891,0.0,1.0],[32.5117013027651,19.0709696852617,0.0,1.0],[29.305019764528,18.9545691109581,0.0,1.0],[24.4759113345748,20.2570787967781,0.0,1.0],[19.8072187451783,22.9775182612717,0.0,1.0],[16.5291821840059,25.277806927272,0.0,1.0],[10.7566166245341,28.5122919557571,0.0,1.0],[6.36970146209175,29.8034933598624,0.0,1.0],[-0.405973075502234,30.1500578730274,0.0,1.0],[-7.53032772904185,27.7630095130657,0.0,1.0],[-10.9967405848897,23.4446538263345,0.0,1.0],[-11.7945553145768,18.0098876247875,0.0,1.0],[-9.84329815385971,12.9293912425976,0.0,1.0],[-2.64821833398598,7.33684919790624,0.0,1.0],[-0.139159724307982,5.41310565569044,0.0,1.0],[1.00846697640521,3.25999992647677,0.0,1.0],[1.7076976610908,-2.501572642794,0.0,1.0],[5.90118769712182,-9.36241405660719,0.0,1.0],[10.4108490166236,-11.5249176387577,0.0,1.0],[16.6611999625517,-12.7135418322201,0.0,1.0],[20.2513584750154,-13.4902268953088,0.0,1.0],[23.7938485314227,-14.6351269687361,0.0,1.0],[30.7681622622371,-17.739262619614,0.0,1.0],[33.7897740653103,-19.5166383512928,0.0,1.0],[35.8614855279756,-21.5808775016001,0.0,1.0],[36.8711477182864,-25.4557910211687,0.0,1.0],[35.5175477601575,-29.6867414698392,0.0,1.0],[33.5888282300982,-31.9233335254203,0.0,1.0],[29.6211021726631,-33.5886007841515,0.0,1.0],[26.2183096377485,-33.68480226464,0.0,1.0],[22.3208062313579,-33.3726612899257,0.0,1.0],[14.1429922166079,-33.1731958647648,0.0,1.0],[10.3778348140314,-33.0132052855498,0.0,1.0],[6.84064584789227,-32.4725374962639,0.0,1.0],[3.27322533222869,-31.4640545504384,0.0,1.0],[-4.09627739578414,-28.8238238024923,0.0,1.0],[-7.65255868890126,-27.3645667343373,0.0,1.0],[-11.077254916009,-25.7164049091686,0.0,1.0],[-16.185233511045,-22.8738429891042,0.0,1.0],[-19.628089973309,-20.8717543910881,0.0,1.0],[-24.4790807692059,-17.8277052050408,0.0,1.0],[-28.5448479313762,-14.3530174024786,0.0,1.0],[-30.6444406510768,-11.6234683085559,0.0,1.0],[-32.2692264908853,-8.52739205631154,0.0,1.0],[-34.1160057737752,-1.6080377618219,0.0,1.0],[-34.4624174228984,2.11880932640591,0.0,1.0],[-34.5779532171168,5.97700580252438,0.0,1.0],[-34.6203010935088,11.9628384547546,0.0,1.0],[-34.6751545298116,15.9616504117489,0.0,1.0],[-34.7332354577762,21.9093507078716,0.0,1.0],[-34.6466389854161,27.7320065787716,0.0,1.0],[-34.1674004338218,30.9833511541837,0.0,1.0],[-32.9540435069214,33.3001054449054,0.0,1.0],[-28.7867224485036,35.7027232116937,0.0,1.0],[-21.7623826032159,39.595866321033,0.0,1.0],[-18.5286281071084,40.9596629960629,0.0,1.0],[-15.2947586791386,41.6060043323431,0.0,1.0],[-9.64289482747188,41.5853268011948,0.0,1.0],[-5.58318659783131,41.5226049040385,0.0,1.0],[0.4754310943428,41.5765527022834,0.0,1.0],[6.49447171658257,41.7389113024907,0.0,1.0],[10.4848751821667,41.8690573815958,0.0,1.0],[14.4579005366844,41.9894100214277,0.0,1.0]])
    outerConePosition = np.array([[8.29483356036796,47.8005083348189,0.0,2.0],[12.2903853701921,47.9291209919643,0.0,2.0],[16.3042155724446,48.0371512121282,0.0,2.0],[24.3872198920862,48.0953719564451,0.0,2.0],[28.4542241392916,47.9967391176812,0.0,2.0],[32.5715480310539,47.7694057800486,0.0,2.0],[36.9671887094624,47.1090924863221,0.0,2.0],[43.5486168233166,43.9466679046951,0.0,2.0],[47.8711744070693,38.045874156376,0.0,2.0],[49.2095764033813,33.5308461962448,0.0,2.0],[48.9402528124274,26.3442245678724,0.0,2.0],[46.9718766730536,21.8331831495909,0.0,2.0],[42.034452284309,16.7521854290723,0.0,2.0],[35.7974585974047,13.6826661179064,0.0,2.0],[31.1302557069132,12.9121393769316,0.0,2.0],[26.4275819814214,13.3378047377686,0.0,2.0],[20.0475993937396,15.7534500265274,0.0,2.0],[14.7344934919394,19.210358215895,0.0,2.0],[11.5833537070008,21.3477072094266,0.0,2.0],[6.90006888859156,23.510122114402,0.0,2.0],[3.54614319085073,24.1525066527486,0.0,2.0],[-1.49646987010121,23.9423419780574,0.0,2.0],[-4.87663538345929,22.0841121388762,0.0,2.0],[-5.81567263287249,19.9085084532591,0.0,2.0],[-5.53917605118359,17.497740705306,0.0,2.0],[-4.05317915721677,15.4107620877673,0.0,2.0],[2.38653784056378,11.1712478467585,0.0,2.0],[5.87263326747036,7.25460792254726,0.0,2.0],[7.22868549746256,2.31823546262226,0.0,2.0],[7.9750905618407,-2.7261923758349,0.0,2.0],[10.6601317831479,-5.23084300440234,0.0,2.0],[13.7805173778787,-6.17261534649334,0.0,2.0],[19.7388585053217,-7.18913620702706,0.0,2.0],[23.8771264994103,-8.31301696223576,0.0,2.0],[27.8385154732156,-9.77726113305095,0.0,2.0],[35.3884273243004,-13.4149776838374,0.0,2.0],[39.1922962154652,-16.2493960759111,0.0,2.0],[42.0705518955054,-20.6153105774461,0.0,2.0],[42.5147079384368,-28.247846055385,0.0,2.0],[39.1831183440142,-34.8167170198948,0.0,2.0],[35.2523671945937,-37.9984770098583,0.0,2.0],[28.1270516052592,-39.715335638822,0.0,2.0],[23.8121031317075,-39.5240911796868,0.0,2.0],[19.9742827992146,-39.2418187116909,0.0,2.0],[11.9928246424488,-39.1219447460144,0.0,2.0],[7.69014987529461,-38.7364552625087,0.0,2.0],[3.42382206323132,-37.786979727176,0.0,2.0],[-0.541821138011257,-36.5027177844325,0.0,2.0],[-8.16436000121084,-33.6653461038145,0.0,2.0],[-11.9792230934156,-31.9752972248347,0.0,2.0],[-15.6623928384561,-30.0682796038662,0.0,2.0],[-20.9238240938196,-27.0586776214187,0.0,2.0],[-24.4077080359509,-25.0144494209715,0.0,2.0],[-29.6698538901663,-21.4381474644069,0.0,2.0],[-34.4107565227371,-16.6961594315364,0.0,2.0],[-36.8313109009813,-12.8998963192641,0.0,2.0],[-38.5811746376266,-8.808929921604,0.0,2.0],[-40.3011807339499,-0.309611756649864,0.0,2.0],[-40.5382789183978,3.86217286202336,0.0,2.0],[-40.5919497511314,7.92466131148779,0.0,2.0],[-40.6457557289961,13.8810850824754,0.0,2.0],[-40.7017394704418,17.8763494567535,0.0,2.0],[-40.7282871101318,23.9204396925825,0.0,2.0],[-40.429160406945,30.2970202551981,0.0,2.0],[-38.9665731582284,35.0689826553948,0.0,2.0],[-35.2924298638551,39.105243893059,0.0,2.0],[-29.7935826692359,41.9483259837501,0.0,2.0],[-22.4882559681602,45.8771756304123,0.0,2.0],[-18.1093389106216,47.2629205744315,0.0,2.0],[-13.5681633690504,47.6776546092619,0.0,2.0],[-7.51988574761303,47.5414613781388,0.0,2.0],[-3.5905890292448,47.5236739806379,0.0,2.0],[2.33404449770947,47.6205092826547,0.0,2.0],[8.29483356036796,47.8005083348189,0.0,2.0],[12.2903853701921,47.9291209919643,0.0,2.0],[16.3042155724446,48.0371512121282,0.0,2.0]])
    
    # new track
    #outside_cone_points = np.array([[40.0, 0.0], [39.876693349325116, 3.1383638291137976], [39.507533623805514, 6.2573786016092345], [38.894796815907064, 9.337814554236216], [38.04226065180614, 12.360679774997896], [36.95518130045147, 15.307337294603592], [35.640260967534715, 18.15961998958187], [34.10560657416369, 20.899942588637952], [32.3606797749979, 23.511410091698927], [30.416238624001238, 25.977921933207348], [28.284271247461902, 28.2842712474619], [25.977921933207348, 30.416238624001238], [23.511410091698927, 32.3606797749979], [20.899942588637956, 34.10560657416369], [18.159619989581874, 35.640260967534715], [15.307337294603593, 36.95518130045147], [12.360679774997898, 38.04226065180614], [9.33781455423622, 38.894796815907064], [6.257378601609237, 39.507533623805514], [3.1383638291138, 39.876693349325116], [2.4492935982947065e-15, 40.0], [-3.138363829113795, 39.876693349325116], [-6.257378601609233, 39.507533623805514], [-9.337814554236214, 38.894796815907064], [-12.360679774997894, 38.042260651806146], [-15.307337294603588, 36.95518130045147], [-18.159619989581866, 35.640260967534715], [-20.899942588637952, 34.105606574163694], [-23.51141009169892, 32.3606797749979], [-25.97792193320734, 30.41623862400124], [-28.2842712474619, 28.284271247461902], [-30.416238624001238, 25.97792193320735], [-32.36067977499789, 23.51141009169893], [-34.10560657416369, 20.899942588637956], [-35.640260967534715, 18.159619989581874], [-36.95518130045147, 15.307337294603595], [-38.04226065180614, 12.3606797749979], [-38.894796815907064, 9.337814554236221], [-39.50753362380551, 6.257378601609239], [-39.876693349325116, 3.1383638291138025], [-40.0, 4.898587196589413e-15], [-39.876693349325116, -3.1383638291137927], [-39.507533623805514, -6.257378601609229], [-38.894796815907064, -9.33781455423621], [-38.042260651806146, -12.360679774997891], [-36.95518130045147, -15.307337294603586], [-35.640260967534715, -18.159619989581866], [-34.105606574163694, -20.89994258863795], [-32.360679774997905, -23.51141009169892], [-30.41623862400124, -25.97792193320734], [-28.28427124746191, -28.2842712474619], [-25.977921933207362, -30.416238624001224], [-23.51141009169893, -32.36067977499789], [-20.89994258863794, -34.105606574163694], [-18.159619989581877, -35.640260967534715], [-15.307337294603613, -36.95518130045146], [-12.360679774997902, -38.04226065180614], [-9.337814554236205, -38.894796815907064], [-6.257378601609242, -39.50753362380551], [-3.138363829113823, -39.876693349325116], [-7.347880794884118e-15, -40.0], [3.1383638291138083, -39.876693349325116], [6.257378601609227, -39.507533623805514], [9.337814554236191, -38.89479681590707], [12.36067977499789, -38.042260651806146], [15.3073372946036, -36.955181300451464], [18.159619989581866, -35.64026096753472], [20.899942588637934, -34.1056065741637], [23.511410091698917, -32.360679774997905], [25.977921933207355, -30.41623862400123], [28.284271247461895, -28.28427124746191], [30.41623862400122, -25.97792193320737], [32.36067977499789, -23.511410091698934], [34.105606574163694, -20.89994258863795], [35.640260967534715, -18.159619989581877], [36.95518130045146, -15.307337294603617], [38.04226065180614, -12.360679774997905], [38.894796815907064, -9.337814554236207], [39.50753362380551, -6.257378601609245], [39.876693349325116, -3.1383638291138247]])
    #inside_cone_points = np.array([[38.0, 0.0], [37.88285868185886, 2.981445637658108], [37.53215694261524, 5.944509671528773], [36.95005697511171, 8.870923826524406], [36.14014761921583, 11.742645786248001], [35.1074222354289, 14.541970429873412], [33.85824791915798, 17.251638990102776], [32.4003262454555, 19.854945459206053], [30.742645786248005, 22.33583958711398], [28.895426692801177, 24.67902583654698], [26.870057685088806, 26.870057685088803], [24.67902583654698, 28.895426692801177], [22.33583958711398, 30.742645786248005], [19.854945459206057, 32.4003262454555], [17.25163899010278, 33.858247919157975], [14.541970429873414, 35.1074222354289], [11.742645786248003, 36.14014761921583], [8.870923826524407, 36.95005697511171], [5.944509671528775, 37.53215694261524], [2.9814456376581098, 37.88285868185886], [2.326828918379971e-15, 38.0], [-2.9814456376581053, 37.88285868185886], [-5.944509671528771, 37.53215694261524], [-8.870923826524402, 36.950056975111714], [-11.742645786248, 36.14014761921584], [-14.541970429873409, 35.1074222354289], [-17.251638990102773, 33.85824791915798], [-19.854945459206053, 32.40032624545551], [-22.335839587113973, 30.742645786248005], [-24.679025836546973, 28.89542669280118], [-26.870057685088803, 26.870057685088806], [-28.895426692801177, 24.679025836546984], [-30.742645786247998, 22.335839587113984], [-32.4003262454555, 19.854945459206057], [-33.858247919157975, 17.25163899010278], [-35.1074222354289, 14.541970429873416], [-36.14014761921583, 11.742645786248005], [-36.95005697511171, 8.870923826524411], [-37.53215694261523, 5.9445096715287775], [-37.88285868185886, 2.9814456376581124], [-38.0, 4.653657836759942e-15], [-37.88285868185886, -2.981445637658103], [-37.53215694261524, -5.944509671528768], [-36.950056975111714, -8.8709238265244], [-36.14014761921584, -11.742645786247996], [-35.1074222354289, -14.541970429873407], [-33.85824791915798, -17.251638990102773], [-32.40032624545551, -19.85494545920605], [-30.74264578624801, -22.335839587113973], [-28.89542669280118, -24.679025836546973], [-26.870057685088813, -26.870057685088803], [-24.679025836546995, -28.895426692801163], [-22.335839587113984, -30.742645786247998], [-19.854945459206046, -32.40032624545551], [-17.251638990102784, -33.858247919157975], [-14.541970429873432, -35.107422235428885], [-11.742645786248007, -36.14014761921583], [-8.870923826524395, -36.950056975111714], [-5.944509671528779, -37.53215694261523], [-2.9814456376581315, -37.88285868185886], [-6.980486755139913e-15, -38.0], [2.9814456376581178, -37.88285868185886], [5.944509671528766, -37.53215694261524], [8.87092382652438, -36.95005697511172], [11.742645786247994, -36.14014761921584], [14.54197042987342, -35.10742223542889], [17.251638990102773, -33.85824791915798], [19.854945459206036, -32.40032624545552], [22.33583958711397, -30.74264578624801], [24.679025836546987, -28.89542669280117], [26.8700576850888, -26.870057685088813], [28.89542669280116, -24.679025836547], [30.742645786247998, -22.335839587113988], [32.40032624545551, -19.85494545920605], [33.858247919157975, -17.251638990102784], [35.107422235428885, -14.541970429873436], [36.14014761921583, -11.74264578624801], [36.950056975111714, -8.870923826524397], [37.53215694261523, -5.944509671528783], [37.88285868185886, -2.9814456376581338]])
    

    # rd_area = cv2.arcLength(outerConePosition[:,0:2].astype(np.float32), closed=True) - \
    # cv2.arcLength(innerConePosition[:,0:2].astype(np.float32), closed=True)
            
    # # Avg length
    # rd_len = (cv2.contourArea(innerConePosition[:,0:2].astype(np.float32)) + \
    #         cv2.contourArea(outerConePosition[:,0:2].astype(np.float32)))/2

    # rd_w = abs(rd_area/ rd_len)
    # print(rd_w)

    # Valore desiderato (in metri) diviso valore attuale
    #scale_factor = 0.003/rd_w
    scale_factor = 0.35
    scaled_inner = scale_track(innerConePosition, scale_factor)
    scaled_outer = scale_track(outerConePosition, scale_factor)
    
    
    np.savetxt("/home/tazio/Desktop/psd_DaGGER/world/cones_position/coneIN_track0.csv", scaled_inner,  
              delimiter = ",")
    np.savetxt("/home/tazio/Desktop/psd_DaGGER/world/cones_position/coneOUT_track0.csv", scaled_outer,  
              delimiter = ",")
    
    #print(scaled_inner)

    sdf_content = generate_sdf(scaled_inner, scaled_outer)
    

    with open("/home/tazio/Desktop/psd_DaGGER/world/track/track0.sdf", "w") as f:
        f.write(sdf_content)

if __name__ == "__main__":
    main()